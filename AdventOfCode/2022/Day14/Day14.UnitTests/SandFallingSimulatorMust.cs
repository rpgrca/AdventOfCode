using Day14.Logic;
using static Day14.UnitTests.Constants;

namespace Day14.UnitTests;

public class SandFallingSimulatorMust
{
    [Fact]
    public void LoadSampleMapCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        Assert.Equal(@"..........
..........
..........
..........
....#...##
....#...#.
..###...#.
........#.
........#.
#########.", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(0, sut.UnitsOfSand);
    }

    [Fact]
    public void LoadPuzzleMapCorrectly()
    {
        var sut = new SandFallingSimulator(PUZZLE_INPUT);
        Assert.Equal(@".............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
...............................................######........
.............................................................
............................................######.######....
.............................................................
.........................................######.######.######
.............................................................
.............................................................
......................................#####..................
.............................................................
.............................................................
...................................#####.#####...............
.............................................................
.............................................................
................................#####.#####.#####............
.............................................................
.............................................................
.............................#####.#####.#####.#####.........
.............................................................
.............................................................
................................#............................
...........................######............................
.............................................................
.............................................................
........................#...#................................
........................#...#................................
..................#######...#####............................
..................#.............#............................
..................#.............#............................
..................###############............................
.............................................................
.............................................................
.............................................................
.................................#...........................
.................................#...........................
...............................#.#...........................
...............................#.#...........................
...............................#.#...........................
...............................#.#...........................
...............................#.#...........................
...............................#.#.#.........................
...............................#.#.#.........................
...............................#####.........................
.............................................................
.............................................................
.............................................................
.............................................................
...........................#.................................
...........................###################...............
.............................................................
.............................................................
...........................................######............
.............................................................
........................................######.######........
.............................................................
.....................................######.######.######....
.............................................................
..................................######.######.######.######
.............................................................
.............................................................
.............................................................
........................#...........#........................
........................#############........................
.............................................................
.............................................................
....................######...................................
.............................................................
.................######.######...............................
.............................................................
..............######.######.######...........................
.............................................................
.............................................................
............#...#............................................
............#...#............................................
............#...#............................................
.....########...####.........................................
.....#.............#.........................................
.....#.............#.........................................
.....#.............#.........................................
.....###############.........................................
.............................................................
.............................................................
.............................................................
.............................................................
.............................................................
...#.........................................................
...#.........................................................
...#.........................................................
...#.#.......................................................
...#.#.......................................................
...#.#.......................................................
.#.#.#.......................................................
.#####.......................................................
.............................................................
.............................................................
....#....#...................................................
....#....#...................................................
....#....#...................................................
#####....#########...........................................
#................#...........................................
#................#...........................................
#................#...........................................
##################...........................................
.............................................................
.............................................................
...............#.....#.......................................
...............#.....#.......................................
...............#.....#.......................................
..............##.....######..................................
..............#...........#..................................
..............#...........#..................................
..............#############..................................
.............................................................
.............................................................
.............................................................
.............................................................
.......................#.....................................
.......................#.....................................
.....................#.#.....................................
.....................#.#.....................................
.....................#.#.#.....#.............................
.....................#.#.#.#.#.#.............................
.....................#.#.#.#.#.#.............................
.....................#.#.#.#.#.#.............................
.....................###########.............................
.............................................................
.............................................................
.............................................................
...........................############......................
.............................................................
.............................................................
.......................................#.....................
.......................................#.....................
...................................#...#.....................
...................................#...#.....................
...................................#...#.....................
...................................#...#.#...................
...................................#...#.#...................
...................................#...#.#...................
...................................#...#.#...................
...................................#.#.#.#...................
...................................#######...................", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(0, sut.UnitsOfSand);
    }

    [Fact]
    public void DropSandDownCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropUnitOfSands(1);
        Assert.Equal(@"..........
..........
..........
..........
....#...##
....#...#.
..###...#.
........#.
......o.#.
#########.", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(1, sut.UnitsOfSand);
    }

    [Fact]
    public void RollSandLeftCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropUnitOfSands(2);
        Assert.Equal(@"..........
..........
..........
..........
....#...##
....#...#.
..###...#.
........#.
.....oo.#.
#########.", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(2, sut.UnitsOfSand);
    }

    [Fact]
    public void RollSandRightCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropUnitOfSands(5);
        Assert.Equal(@"..........
..........
..........
..........
....#...##
....#...#.
..###...#.
......o.#.
....oooo#.
#########.", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(5, sut.UnitsOfSand);
    }

    [Theory]
    [InlineData(22, @"..........
..........
......o...
.....ooo..
....#ooo##
....#ooo#.
..###ooo#.
....oooo#.
...ooooo#.
#########.")]
    [InlineData(24, @"..........
..........
......o...
.....ooo..
....#ooo##
...o#ooo#.
..###ooo#.
....oooo#.
.o.ooooo#.
#########.")]
    public void SimulateSandFallingCorrectly(int units, string expectedMap)
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropUnitOfSands(units);
        Assert.Equal(expectedMap, sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(units, sut.UnitsOfSand);
    }

    [Fact]
    public void SimulateSandFallingToTheAbyssCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropUnitOfSands(25);
        Assert.Equal(@"..........
..........
......o...
.....ooo..
....#ooo##
...o#ooo#.
..###ooo#.
....oooo#.
.o.ooooo#.
#########.", sut.GetVisualMap());
        Assert.True(sut.MapFilled);
        Assert.Equal(24, sut.UnitsOfSand);
    }

    [Fact]
    public void SolveFirstSampleCorrectly()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT);
        sut.DropSandUntilFilled();
        Assert.Equal(24, sut.UnitsOfSand);
    }

    [Fact]
    public void SolveFirstPuzzleCorrectly()
    {
        var sut = new SandFallingSimulator(PUZZLE_INPUT);
        sut.DropSandUntilFilled();
        Assert.Equal(774, sut.UnitsOfSand);
    }

    [Fact]
    public void Test1()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT, true);
        Assert.Equal(@"..............................
..............................
..............................
..............................
..............#...##..........
..............#...#...........
............###...#...........
..................#...........
..................#...........
..........#########...........
..............................
##############################", sut.GetVisualMap());
        Assert.False(sut.MapFilled);
        Assert.Equal(0, sut.UnitsOfSand);
    }

    [Fact]
    public void SolveSecondSample()
    {
        var sut = new SandFallingSimulator(SAMPLE_INPUT, true);
        sut.DropSandUntilEntranceIsBlocked();
        Assert.Equal(@"................o.............
...............ooo............
..............ooooo...........
.............ooooooo..........
............oo#ooo##o.........
...........ooo#ooo#ooo........
..........oo###ooo#oooo.......
.........oooo.oooo#ooooo......
........oooooooooo#oooooo.....
.......ooo#########ooooooo....
......ooooo.......ooooooooo...
##############################", sut.GetVisualMap());
        Assert.Equal(93, sut.UnitsOfSand);
    }

    [Fact]
    public void SolveSecondPuzzle()
    {
        var sut = new SandFallingSimulator(PUZZLE_INPUT, true);
        sut.DropSandUntilEntranceIsBlocked();
        Assert.Equal(@"............................................................................................................................................................................................................o....................................................................................................................................................................
...........................................................................................................................................................................................................ooo...................................................................................................................................................................
..........................................................................................................................................................................................................ooooo..................................................................................................................................................................
.........................................................................................................................................................................................................ooooooo.................................................................................................................................................................
........................................................................................................................................................................................................ooooooooo................................................................................................................................................................
.......................................................................................................................................................................................................ooooooooooo...............................................................................................................................................................
......................................................................................................................................................................................................ooooooooooooo..............................................................................................................................................................
.....................................................................................................................................................................................................ooooooooooooooo.............................................................................................................................................................
....................................................................................................................................................................................................ooooooooooooooooo............................................................................................................................................................
...................................................................................................................................................................................................ooooooooooooooooooo...........................................................................................................................................................
..................................................................................................................................................................................................ooooooooooooooooooooo..........................................................................................................................................................
.................................................................................................................................................................................................ooooooooooooooooooooooo.........................................................................................................................................................
................................................................................................................................................................................................ooooooooooooooooooooooooo........................................................................................................................................................
...............................................................................................................................................................................................oooooooooo######ooooooooooo.......................................................................................................................................................
..............................................................................................................................................................................................oooooooooooo....ooooooooooooo......................................................................................................................................................
.............................................................................................................................................................................................ooooooooo######.######ooooooooo.....................................................................................................................................................
............................................................................................................................................................................................ooooooooooo...........ooooooooooo....................................................................................................................................................
...........................................................................................................................................................................................oooooooo######.######.######ooooooo...................................................................................................................................................
..........................................................................................................................................................................................oooooooooo..................ooooooooo..................................................................................................................................................
.........................................................................................................................................................................................oooooooooooo................ooooooooooo.................................................................................................................................................
........................................................................................................................................................................................oooooooo#####o..............ooooooooooooo................................................................................................................................................
.......................................................................................................................................................................................oooooooooo...ooo............ooooooooooooooo...............................................................................................................................................
......................................................................................................................................................................................oooooooooooo.ooooo..........ooooooooooooooooo..............................................................................................................................................
.....................................................................................................................................................................................oooooooo#####o#####o........ooooooooooooooooooo.............................................................................................................................................
....................................................................................................................................................................................oooooooooo...ooo...ooo......ooooooooooooooooooooo............................................................................................................................................
...................................................................................................................................................................................oooooooooooo.ooooo.ooooo....ooooooooooooooooooooooo...........................................................................................................................................
..................................................................................................................................................................................oooooooo#####o#####o#####o..ooooooooooooooooooooooooo..........................................................................................................................................
.................................................................................................................................................................................oooooooooo...ooo...ooo...oooooooooooooooooooooooooooooo.........................................................................................................................................
................................................................................................................................................................................oooooooooooo.ooooo.ooooo.oooooooooooooooooooooooooooooooo........................................................................................................................................
...............................................................................................................................................................................oooooooo#####o#####o#####o#####oooooooooooooooooooooooooooo.......................................................................................................................................
..............................................................................................................................................................................oooooooooo...ooo...ooo...ooo...oooooooooooooooooooooooooooooo......................................................................................................................................
.............................................................................................................................................................................oooooooooooo.ooooo.ooooo.ooooo.oooooooooooooooooooooooooooooooo.....................................................................................................................................
............................................................................................................................................................................oooooooooooooo#oooooooooooooooooooooooooooooooooooooooooooooooooo....................................................................................................................................
...........................................................................................................................................................................oooooooooo######ooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................................................................................................
..........................................................................................................................................................................oooooooooooo....ooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................................................................................................
.........................................................................................................................................................................oooooooooooooo..ooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................................................................................................
........................................................................................................................................................................oooooooooo#ooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................................................................................................
.......................................................................................................................................................................ooooooooooo#ooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................................................................................................
......................................................................................................................................................................oooooo#######ooo#####oooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................................................................................................
.....................................................................................................................................................................ooooooo#.....ooooo...#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................................................................................................
....................................................................................................................................................................oooooooo#....ooooooo..#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................................................................................................
...................................................................................................................................................................ooooooooo###############ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................................................................................................
..................................................................................................................................................................ooooooooooo.............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................................................................................................
.................................................................................................................................................................ooooooooooooo...........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................................................................................................
................................................................................................................................................................ooooooooooooooo.........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................................................................................................
...............................................................................................................................................................ooooooooooooooooo.......oooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................................................................................................
..............................................................................................................................................................ooooooooooooooooooo.....ooooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................................................................................................
.............................................................................................................................................................ooooooooooooooooooooo...oooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................................................................................................
............................................................................................................................................................ooooooooooooooooooooooo.ooooo#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................................................................................................
...........................................................................................................................................................oooooooooooooooooooooooooooooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................................................................................
..........................................................................................................................................................ooooooooooooooooooooooooooooooo#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................................................................................
.........................................................................................................................................................oooooooooooooooooooooooooooooooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................................................................................
........................................................................................................................................................ooooooooooooooooooooooooooooooooo#o#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................................................................................
.......................................................................................................................................................oooooooooooooooooooooooooooooooooo#o#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................................................................................
......................................................................................................................................................ooooooooooooooooooooooooooooooooooo#####ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................................................................................
.....................................................................................................................................................ooooooooooooooooooooooooooooooooooooo...ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................................................................................
....................................................................................................................................................ooooooooooooooooooooooooooooooooooooooo.ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................................................................................
...................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................................................................................
..................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................................................................................
.................................................................................................................................................oooooooooooooooooooooooooooooooooooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................................................................................
................................................................................................................................................ooooooooooooooooooooooooooooooooooooo###################ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................................................................................
...............................................................................................................................................ooooooooooooooooooooooooooooooooooooooo.................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................................................................................
..............................................................................................................................................ooooooooooooooooooooooooooooooooooooooooo...............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................................................................................
.............................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooo.............######ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................................................................................
............................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooo.................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................................................................................
...........................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooo........######.######ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................................................................
..........................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooo...................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................................................................
.........................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooo...######.######.######ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................................................................
........................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................................................................
.......................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooo######.######.######.######ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................................................................
......................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................................................................
.....................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................................................................
....................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................................................................
...................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooo#ooooooooooo#o...................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................................................................
..................................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooo#############oo.................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................................................................
.................................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooo...........oooo...............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................................................................
................................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooo.........oooooo.............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................................................................
...............................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooo######o.......oooooooo...........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................................................................
..............................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooo....ooo.....oooooooooo.........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................................................................
.............................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooo######.######..oooooooooooo.......ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................................................................
............................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooo.............oooooooooooooo.....ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................................................................
...........................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooo######.######.######oooooooooooo...ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................................................
..........................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooo..................oooooooooooooo.ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................................................
.........................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooo................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................................................
........................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooo#ooo#..............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................................................
.......................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooo#ooo#.............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................................................
......................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooo#ooo#............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................................................
.....................................................................................................................oooooooooooooooooooooooooooooooooooooooooo########ooo####........oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................................................
....................................................................................................................ooooooooooooooooooooooooooooooooooooooooooo#......ooooo..#.......oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................................................
...................................................................................................................oooooooooooooooooooooooooooooooooooooooooooo#.....ooooooo.#......oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................................................
..................................................................................................................ooooooooooooooooooooooooooooooooooooooooooooo#....ooooooooo#.....oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................................................
.................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooo###############....oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................................................
................................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooo.................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................................................
...............................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooo...............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................................................
..............................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooo.............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................................................
.............................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooo...........oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................................................
............................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................................................
...........................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooo#ooooooo.......oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................................
..........................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooo#oooooooo.....oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................................
.........................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooo#ooooooooo...oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................................
........................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#oooooooo.oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................................
.......................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................................
......................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................................
.....................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................................
....................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooo#####ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................................
...................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................................
..................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................................
.................................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#oooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................................
................................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#oooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................................
...............................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#oooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................................
..............................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#####oooo#########ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................................
.............................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#...oooooo.......#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................................
............................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#..oooooooo......#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................................
...........................................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#.oooooooooo.....#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................................
..........................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo##################ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................................
.........................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................................
........................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................................
.......................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............#ooooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................................
......................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........#ooooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................................
.....................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........#ooooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................................
....................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........##ooooo######oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................................
...................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......#ooooooo....#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................................
..................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......#oooooooo...#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................................
.................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....#############ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................................
................................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................................
...............................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................................
..............................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................................
.............................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................................
............................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................................
...........................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......oo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................................
..........................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....o#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................................
.........................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..oo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................................
........................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#ooooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................................
.......................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#o#o#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............................
......................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#o#o#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............................
.....................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#o#o#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............................
....................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo###########ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............................
...................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........................
..................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........................
.................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.........................
................................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..############oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........................
...............................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.......................
..............................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......................
.............................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo........ooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....................
............................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo......oooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....................
...........................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo....o#ooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...................
..........................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..oo#ooo#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..................
.........................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#ooo#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.................
........................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#ooo#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo................
.......................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#ooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...............
......................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#ooo#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..............
.....................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#ooo#o#oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.............
....................................................ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#o#o#o#ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo............
...................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo#######oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo...........
..................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo.....oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..........
#################################################################################################################################################################################################################################################################################################################################################################################", sut.GetVisualMap());
        Assert.Equal(22499, sut.UnitsOfSand);
    }
}